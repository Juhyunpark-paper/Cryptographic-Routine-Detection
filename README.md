# Symmetric-Key Cryptographic Routine Detection in Anti-Reverse Engineered Binaries Using Hardware Tracing

This repository is created for the purpose of providing the source code of the paper 'Symmetric-Key Cryptographic Routine Detection in Anti-Reverse Engineered Binaries Using Hardware Tracing'

### Explanantions


*Note* For the shell scripts included in this repository to work properly, this repository directory must be located in the app directory of the OpenSSL 1.1.1e version.


enc.txt: This text file is a list of symmetric-key cryptographic algorithms supported by the enc command of OpenSSL version 1.1.1e. This file is used when creating the test cases.

my_file.txt: This is a text file that stores plaintext to be encrypted. Plaintext is a 1000-bytes long string generated by the Python random module.

PerfTNT.py: This code is a Python parser used to generate patterns of cryptographic algorithms. This parses the TNT packets between PTWRITE packet pair from the input trace.
usage: python PerfTNT.py [-h] [-i INPUT_TRACE_NAME] [-o PARSED_OUTPUT_NAME]

PtwriteTNT.py: This is another Python parser used to detect the pattern of the cryptographic algorithm. This parses all TNT packets from the input trace.
usage: python PtwriteTNT.py [-h] [-i INPUT_TRACE_NAME] [-o PARSED_OUTPUT_NAME]

makeshells.sh: This shell script uses enc.txt and OpenSSL's command line utility to automatically generate shell scripts to be used to create test executables.

makedump.sh: This shell script creates the test executable for each cryptographic algorithm and automatically performs pattern generation process using the result of the makeshells.sh's output and Python parser.

*.dump: Record result of the Intel Processor Trace
*.txt: Pattern generation result
